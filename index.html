<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>龍騰英文 - L01 The Day I Broke the Rules</title>
  
  <!-- Vue.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.45/vue.global.prod.min.js"></script>
  <!-- Vue Router -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/4.1.6/vue-router.global.min.js"></script>
  
  <style>
    /* 標題設定*/
    table {
      margin: 1rem 0.1rem 1rem 0.5rem;
    }
    header {
      margin: 0.5em 0.4em;
    }

    .title-word {
      padding: 0 0.1rem 0 0.8rem;
      font-size: 2.8rem;
      font-weight: 900;
    }
    .title-img {
      height: 3.6rem;
      padding: 0 0.3rem 0 0;
      margin: 0.1rem 0;
    }

    /* 中間內容*/
    section {
      display: inline-block;
      width: 99.5%;
      font-size: 2.2rem;
      font-weight: 800;
      padding:0 0.5rem 0 0.02rem;
    }

    .banner {
      color: #000000;
      padding: 0.3rem 0.2rem 0.3rem 0.2rem;
      margin: 0.05rem 0 0.5rem 0.6rem;
    }

    div {
      margin: 0.1em 0 0.1em 0.4em;
      font-size: 2rem;
    }
    p {
      color: #282828;
      font-weight: 600;
      padding-left: 1rem;
      margin-top:0.2rem;
      margin-left:0.1rem;
    }
    audio {
      width: 98%;
      margin: 0.5rem 0 1rem 0.3rem;
      padding: 0.2rem;
    }

    /* 影片按鈕 */
    .bt {
      margin: 0.2rem -0.5rem 0.6rem 1.5rem;
      font-size: 1.5rem;
      letter-spacing: 0.02rem;
      border: 0.03rem rgba(205,205,205,1) solid;
      width: 9rem;
      height: 2.5rem;
      background-color: #FFF3DC;
      font-weight: bold;
      border-radius: 0.3rem;
    }

    .bt:hover {
      background-color:rgba(251,226,168,1.00);
      transition: all 0.2s linear;
      border: 0.03em rgba(251,226,168,0.3) solid;
    }
    
    /* 聽力測驗 */
    .bt-LS {
      margin: 0.4rem -0.5rem 0.6rem 1.2rem;
      font-size: 1.55rem;
      border: 0.03rem rgba(205,205,205,1) solid;
      width: auto;
      height: 2.8rem;
      padding: 0.4rem 0.8rem 0.3rem;
      background-color: #FFF3DC;
      font-weight: bold;
      border-radius: 0.3rem;
    }

    .bt-LS:hover {
      background-color:rgba(255,240,145,0.5);
      transition: all 0.2s linear;
    }
    
    /*標題按鈕*/
    .A {
      background-color: #ffcccc;
    }
    .B {
      background-color: #b7f274;
    }
    .C {
      background-color: #aaf0eb;
    }
    .D {
      background-color: #fff8a6;
    }
    .E {
      background-color: #e6ccff;
    }
    
    /*標題按鈕變色*/
    .elect-w1:hover {
      color: whitesmoke;
      background-color: #e62789;
    }
    
    /* 底部設定*/
    footer {
      margin: 1.5rem 0 2rem 0.3rem;
      position: relative;
    }

    .buttom-img {
      width: 5rem;
      float: left;
      right: 3vw;
      margin: 0 -0.6rem 0.8rem 1.2rem;
    }
    
    .buttom-word {
      color: black;
      font-size: 1rem;
      left: 1vw;
      float: left;
      margin: 0 0 0 0.3rem;
    }
    
    /* 導航 */
    #nav {
      font-size: 0.9em;
    }
    
    #nav ul {
      list-style: none;
      padding: 0.25em 0.25em 0.5em 0.25em;
      font-size: 1.1em;
    }
    
    #nav ul li {
      float: left;
      line-height: 3.5em;
      padding-left: 1.5em;
    }
    
    #nav ul li a,
    #nav ul li span {
      -moz-transition: background-color .25s ease-in-out;
      -webkit-transition: background-color .25s ease-in-out;
      -ms-transition: background-color .25s ease-in-out;
      transition: background-color .25s ease-in-out;
      font-weight: 800;
      letter-spacing: 0.03em;
      color: #696969;
      text-decoration: none;
      border-radius: 6px;
      padding: 0.25em 0.6em 0.25em 0.6em;
      cursor: pointer;
      font-size: 0.8em;
    }
    
    #nav ul li:hover a,
    #nav ul li:hover span {
      background: #535353;
      color: #fff;
    }
    
    #nav ul li.current a,
    #nav ul li.current span {
      background: #535353;
      color: #fff;
    }
    
    /* 手機版樣式 */
    @media (max-width: 524px) {
      header {
        margin: 0.3em 0;
      }
      
      table {
        margin: 0.1em;
      }
      
      .title-img {
        height: 2em;
        padding: 0 0.2rem 0 0;
      }
      
      .title-word {
        padding: 0.05rem 0.1rem 0.08rem 0.2rem;
        font-size: 18pt;
      }
      
      audio {
        width: 100%;
        margin: 0 0 0.1rem -0.1rem;
        padding: 0.65rem 0.25rem;
      }
      
      section {
        width: 100%;
        font-size: 16pt;
        font-weight: 800;
      }
      
      .banner {
        color: #000000;
        padding: 0.1em 0.2em 0.2em 0.2em;
        margin: 0.1em 0.15em 0.2em 0.15em;
      }
      
      div {
        margin: 0.15rem 0.1rem 0.1rem 0.33rem;
        font-size: 1.2rem;
      }
      
      p {
        font-weight: 600;
        padding-left: 0.3rem;
        letter-spacing: -0.5px;
      }
      
      .bt {
        font-size: 0.9rem;
        letter-spacing: -1px;
        margin: 0.1rem -0.6rem 0.5rem 0.7rem;
        width: 4.8rem;
        height: 1.6rem;
      }
      
      .bt-LS {
        font-size: 11pt;
        margin: 0.2rem 0 0.2rem 0.1rem;
        width: auto;
        height: 25px;
        padding: 0.2em 0.4rem 0.2em;
      }
      
      footer {
        margin: 1rem 0.1rem 2rem;
      }
      
      .buttom-img {
        width: 3rem;
        left: 0;
        margin: 0 -0.8rem 0.4rem 0.5rem;
      }
      
      .buttom-word {
        font-size: 0.6rem;
        left: 2em;
        margin: 0.1rem 0 0 0.8rem;
      }
      
      #nav ul {
        padding: 0.1em 0.1em;
        font-size: 0.6em;
        letter-spacing: 0.04em;
      }
      
      #nav ul li {
        line-height: 4.5em;
        padding-left: 0.6em;
      }
      
      #nav ul li a,
      #nav ul li span {
        font-weight: 650;
        letter-spacing: 0.05em;
        padding: 0.3em 0.6em 0.3em 0.6em;
        margin-left: 0.25em;
        font-size: 0.8em;
      }
    }

    /* Clear fix for nav */
    #nav ul:after {
      content: "";
      display: block;
      clear: both;
    }
    
    /* Vue specific styles */
    [v-cloak] {
      display: none;
    }
    
    .view-container {
      min-height: 300px;
    }
    
    /* 加載指示器樣式 */
    .loading-container {
      text-align: center;
      padding: 2rem;
      font-size: 1.5rem;
      color: #666;
    }
    
    .fade-enter-active, .fade-leave-active {
      transition: opacity 0.3s;
    }
    .fade-enter-from, .fade-leave-to {
      opacity: 0;
    }
  </style>
</head>
<body>
  <div id="app" v-cloak>
    <!-- 標題 -->
    <header>
      <table>
        <tr>
          <td><img class="title-img" src="../object/TOP.png" alt="英文3"></td>
          <td class="title-word">L01 The Day I Broke the Rules</td>
        </tr>
      </table>
      
      <!-- 導航 -->
      <nav id="nav">
        <ul>
          <li :class="{ current: currentView === 'reading' }">
            <a @click="changeView('reading')">課文影音</a>
          </li>
          <li :class="{ current: currentView === 'thinking' }">
            <a @click="changeView('thinking')">Thinking Ahead</a>
          </li>
          <li :class="{ current: currentView === 'words' }">
            <a @click="changeView('words')">單字詞彙</a>
          </li>
          <li :class="{ current: currentView === 'listening' }">
            <a @click="changeView('listening')">聽力音檔</a>
          </li>
        </ul>
      </nav>
    </header>
    
    <!-- 加載指示器 -->
    <div v-if="isLoading" class="loading-container">
      <p>正在加載內容數據...</p>
    </div>
    
    <!-- 主要內容區 -->
    <div class="view-container">
      <!-- 讀文視圖 -->
      <div v-if="currentView === 'reading'">
        <!-- 課文動畫 -->
        <section @click="toggleSection('section1')">
          <p class="banner D elect-w1">&nbsp;課文動畫</p>
        </section>
        
        <div v-if="visibleSections.section1">
          <button 
            v-for="item in getContentByCategory('課文動畫')" 
            :key="item.標題" 
            class="bt" 
            @click="openURL(item['URL/檔案路徑'])">
            {{ item.標題 }}
          </button>
        </div>
        
        <!-- Edpuzzle -->
        <section>
          <p class="banner A elect-w1" @click="openURL(getContentUrl('課文Edpuzzle', '課文Edpuzzle'))">&nbsp;課文Edpuzzle</p>
        </section>
        
        <!-- 課文朗讀 -->
        <section @click="toggleSection('section2')">
          <p class="banner D elect-w1">&nbsp;課文朗讀</p>
        </section>
        
        <div v-if="visibleSections.section2">
          <div v-for="item in getContentByCategory('課文朗讀')" :key="item.標題">
            <p>{{ item.標題 }}</p>
            <audio controls>
              <source :src="item['URL/檔案路徑']" type="audio/mpeg">
            </audio>
          </div>
        </div>
        
        <!-- 課文講解影片 -->
        <section>
          <p class="banner A elect-w1" @click="openURL(getContentUrl('課文講解影片', '課文講解影片'))">&nbsp;課文講解影片</p>
        </section>
      </div>
      
      <!-- Thinking Ahead視圖 -->
      <div v-if="currentView === 'thinking'">
        <section>
          <p class="banner A"><b>&nbsp;Thinking Ahead</b></p>
        </section>
        
        <div>
          <button 
            v-for="item in getContentByCategory('Thinking Ahead 影片')" 
            :key="item.標題" 
            class="bt" 
            @click="openURL(item['URL/檔案路徑'])">
            {{ item.標題 }}
          </button>
        </div>
      </div>
      
      <!-- 單字詞彙視圖 -->
      <div v-if="currentView === 'words'">
        <section>
          <p class="banner A">&thinsp;字彙朗讀</p>
        </section>
        
        <div>
          <div v-for="item in getContentByCategory('字彙朗讀')" :key="item.標題">
            <p>{{ item.標題 }}</p>
            <audio controls>
              <source :src="item['URL/檔案路徑']" type="audio/mpeg">
            </audio>
          </div>
        </div>
        
        <section>
          <p class="banner D elect-w1" @click="openURL(getContentUrl('Blooket', 'Blooket'))">&nbsp;Blooket</p>
        </section>
      </div>
      
      <!-- 聽力音檔視圖 -->
      <div v-if="currentView === 'listening'">
        <section>
          <p class="banner A"><b>&nbsp;Listening Strategy</b></p>
        </section>
        
        <div>
          <button 
            v-for="item in getContentByCategory('聽力練習')" 
            :key="item.標題" 
            class="bt-LS" 
            @click="openURL(item['URL/檔案路徑'])">
            {{ item.標題 }}
          </button>
        </div>
      </div>
    </div>
    
    <!-- 底部 -->
    <footer>
      <a href="https://bookstore.ltedu.com.tw/" target="_blank">
        <img class="buttom-img" src="../object/logo.png" alt="龍騰文化">
      </a>
      <p class="buttom-word">Copyright @ 2024 版權所有</p>
    </footer>
  </div>

  <script>
    // 當 DOM 加載完成時初始化 Vue 應用
    document.addEventListener('DOMContentLoaded', function() {
      // 創建 Vue 應用
      const app = Vue.createApp({
        data() {
          return {
            currentView: 'reading', // 默認視圖
            visibleSections: {
              section1: false,
              section2: false
            },
            contentData: null, // 初始為空，會從外部JSON檔載入
            isLoading: true // 用於追踪數據加載狀態
          }
          };
        },
        methods: {
          // 切換視圖
          changeView(view) {
            this.currentView = view;
            // 更新瀏覽器歷史記錄，但不重新載入頁面
            if (window.history && window.history.pushState) {
              window.history.pushState({view: view}, '', '#' + view);
            } else {
              // 老舊瀏覽器
              window.location.hash = '#' + view;
            }
          },
          // 切換區塊顯示/隱藏
          toggleSection(section) {
            this.visibleSections[section] = !this.visibleSections[section];
          },
          // 開啟URL
          openURL(url) {
            if (url) window.open(url, '_blank');
          },
          // 從JSON資料獲取URL
          getContentUrl(category, title) {
            if (!this.contentData || !this.contentData.L1) return '';
            const item = this.contentData.L1.find(item => 
              item.分類 === category && item.標題 === title
            );
            return item ? item['URL/檔案路徑'] : '';
          },
          
          // 根據分類獲取內容項目
          getContentByCategory(category) {
            if (!this.contentData || !this.contentData.L1) return [];
            return this.contentData.L1.filter(item => item.分類 === category);
          }
        },
        mounted() {
          // 檢查 URL 哈希值以設置初始視圖
          const hash = window.location.hash.substring(1);
          if (hash && ['reading', 'thinking', 'words', 'listening'].includes(hash)) {
            this.currentView = hash;
          }
          
          // 監聽瀏覽器返回按鈕
          window.addEventListener('popstate', (event) => {
            if (event.state && event.state.view) {
              this.currentView = event.state.view;
            } else {
              this.currentView = 'reading'; // 默認視圖
            }
          });
          
          // 初始歷史記錄
          if (window.history && window.history.replaceState) {
            window.history.replaceState({view: this.currentView}, '', '#' + this.currentView);
          }
          
          // 載入外部JSON數據
          this.loadContent();
        },
        
        methods: {
          // 載入外部JSON數據
          loadContent() {
            this.isLoading = true;
            
            // 使用Fetch API加載JSON文件
            fetch('content_data.json')
              .then(response => {
                if (!response.ok) {
                  throw new Error('無法加載內容數據，HTTP狀態: ' + response.status);
                }
                return response.json();
              })
              .then(data => {
                this.contentData = data;
                this.isLoading = false;
                console.log('內容數據加載成功:', data);
              })
              .catch(error => {
                console.error('加載內容數據時出錯:', error);
                this.isLoading = false;
                // 在這裡可以顯示錯誤訊息給用戶
              });
          },
      });
      
      // 掛載 Vue 應用到 DOM
      app.mount('#app');
    });
  </script>
</body>
</html>